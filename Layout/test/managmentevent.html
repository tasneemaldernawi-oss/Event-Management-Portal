<!DOCTYPE html>
<html lang="en">
<head> 
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css">
    <title>Event Management Portal</title>
    <style>
        .container {
            padding-top: 80px;
        }
        
        .search-form {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .search-form input {
            flex: 1;
            min-width: 200px;
        }
        
        .editBtn, .deleteBtn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 3px;
        }
        
        .editBtn:hover, .deleteBtn:hover {
            opacity: 0.7;
        }
        
        #editBox {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            z-index: 1000;
            min-width: 400px;
            max-width: 90vw;
        }
        
        .status {
            border: none;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }
        
        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .container {
                padding-top: 70px;
            }
            
            .search-form {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-form input {
                min-width: auto;
            }
            
            .table-responsive {
                border: 1px solid #dee2e6;
                border-radius: 0.375rem;
            }
            
            #editBox {
                min-width: auto;
                width: 95vw;
                margin: 0;
            }
        }
    </style>
</head>
<body>
    <div id="header"></div>
    
    <section class="container">
        <h2>Manage Events</h2>
        <p>Create, update, or delete events</p>

        <form role="search" class="search-form">
            <input type="search" id="query" class="form-control" placeholder="Search events...">
            <button type="button" class="btn btn-outline-secondary">
                <i class="fas fa-search"></i>
            </button>
            <button type="button" class="btn btn-secondary" style="background-color: black;">+ Add New Event</button>
        </form>

        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Event Name</th>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Room</th>
                        <th>Faculty</th>
                        <th>Registrations</th>
                        <th>Status</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="myTbody">
                    <tr class="event">
                        <td class="event-name">AI Hackathon 2025</td>
                        <td class="event-date">10/21/2025</td>
                        <td class="event-time">10:00 AM</td>
                        <td class="event-hall">Gaming Hall</td>
                        <td class="event-faculty">Artificial Intelligence</td>
                        <td>45/50</td>
                        <td><span class="status" style="background-color: aquamarine;">upcoming</span></td>
                        <td>
                            <button class="editBtn"><i class="fa-regular fa-pen-to-square"></i></button>
                            <button class="deleteBtn"><i class="fa-solid fa-trash"></i></button>
                        </td>
                    </tr>
                    <tr class="event">
                        <td class="event-name">Engineering Career Fair</td>
                        <td class="event-date">25/10/2025</td>
                        <td class="event-time">09:00 AM</td>
                        <td class="event-hall">Main Hall</td>
                        <td class="event-faculty">Engineering</td>
                        <td>100/150</td>
                        <td><span class="status" style="background-color: aquamarine;">upcoming</span></td>
                        <td>
                            <button class="editBtn"><i class="fa-regular fa-pen-to-square"></i></button>
                            <button class="deleteBtn"><i class="fa-solid fa-trash"></i></button>
                        </td>
                    </tr>
                    <tr class="event">
                        <td class="event-name">Research Symposium</td>
                        <td class="event-date">10/26/2025</td>
                        <td class="event-time">02:00 PM</td>
                        <td class="event-hall">Room 13</td>
                        <td class="event-faculty">Research & Development</td>
                        <td>80/100</td>
                        <td><span class="status" style="background-color: aquamarine;">upcoming</span></td>
                        <td>
                            <button class="editBtn"><i class="fa-regular fa-pen-to-square"></i></button>
                            <button class="deleteBtn"><i class="fa-solid fa-trash"></i></button>
                        </td>
                    </tr>
                    <tr class="event">
                        <td class="event-name">Business Leadership Workshop</td>
                        <td class="event-date">10/28/2025</td>
                        <td class="event-time">01:00 PM</td>
                        <td class="event-hall">Room 26</td>
                        <td class="event-faculty">Business Administration</td>
                        <td>40/40</td>
                        <td><span class="status" style="background-color: aquamarine;">upcoming</span></td>
                        <td>
                            <button class="editBtn"><i class="fa-regular fa-pen-to-square"></i></button>
                            <button class="deleteBtn"><i class="fa-solid fa-trash"></i></button>
                        </td>
                    </tr>
                    <tr class="event">
                        <td class="event-name">Startup Pitch Competition</td>
                        <td class="event-date">10/15/2025</td>
                        <td class="event-time">03:00 PM</td>
                        <td class="event-hall">Room 3</td>
                        <td class="event-faculty">Entrepreneurship Center</td>
                        <td>25/30</td>
                        <td><span class="status" style="background-color: rgb(162, 182, 175);">Completed</span></td>
                        <td>
                            <button class="editBtn"><i class="fa-regular fa-pen-to-square"></i></button>
                            <button class="deleteBtn"><i class="fa-solid fa-trash"></i></button>
                        </td>
                    </tr>
                    <tr class="event">
                        <td class="event-name">Environmental Sustainability Summit</td>
                        <td class="event-date">11/15/2025</td>
                        <td class="event-time">10:00 AM</td>
                        <td class="event-hall">Room 26</td>
                        <td class="event-faculty">Environmental Sciences</td>
                        <td>60/75</td>
                        <td><span class="status" style="background-color: rgb(242, 52, 5); color: white;">Pending</span></td>
                        <td>
                            <button class="editBtn"><i class="fa-regular fa-pen-to-square"></i></button>
                            <button class="deleteBtn"><i class="fa-solid fa-trash"></i></button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

       
        <div id="editBox" style="display:none;">
            <h5>Edit Event Details</h5>

            <div class="mb-3">
                <label class="form-label">Change Event Name</label>
                <input type="text" class="form-control" name="eventinput" id="eventinput">
            </div>

            <div class="mb-3">
                <label class="form-label">Change Date:</label>
                <input type="date" class="form-control" id="dateInput">
            </div>

            <div class="mb-3">
                <label class="form-label">Change Time:</label>
                <select class="form-select" id="timeSelect">
                    <option value="">-- Select Time --</option>
                    <option>09:00 AM</option>
                    <option>10:00 AM</option>
                    <option>11:00 AM</option>
                    <option>12:00 PM</option>
                    <option>02:00 PM</option>
                    <option>03:00 PM</option>
                </select>
            </div>

            <div class="mb-3">
                <label class="form-label">Change Hall:</label>
                <select class="form-select" id="hallSelect">
                    <option value="">-- Select Hall --</option>
                    <option>Main Hall</option>
                    <option>Gaming Hall</option>
                    <option>Room 3</option>
                    <option>Room 13</option>
                    <option>Room 26</option>
                </select>
            </div>

            <div class="mb-3">
                <label class="form-label">Choose Faculty</label>
                <select class="form-select" id="facultySelect">
                    <option value="">-- Select Faculty --</option>
                    <option>Artificial Intelligence</option>
                    <option>Environmental Sciences</option>
                    <option>Entrepreneurship Center</option>
                    <option>Business Administration</option>
                    <option>Research & Development</option>
                    <option>Engineering</option>
                </select>
            </div>

            <div class="mb-3">
                <label class="form-label">Status</label>
                <select class="form-select" id="statusSelect">
                    <option value="">-- Select Status --</option>
                    <option>Upcoming</option>
                    <option>Pending</option>
                    <option>Completed</option>
                </select>
            </div>

            <div class="d-flex gap-2 flex-wrap">
                <button id="applyBtn" class="btn btn-success">Apply</button>
                <button id="deleteBtn" class="btn btn-danger">Delete Event</button>
                <button id="closeBtn" class="btn btn-secondary">Close</button>
            </div>
        </div>
    </section>

    <div id="footer"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
       
        document.addEventListener("DOMContentLoaded", () => {
            fetch("header.html")
                .then(res => res.text())
                .then(data => document.getElementById("header").innerHTML = data);

            fetch("footer.html")
                .then(res => res.text())
                .then(data => document.getElementById("footer").innerHTML = data);
        });

        // Event management functionality
        document.addEventListener("DOMContentLoaded", function() {
            const editBox = document.getElementById("editBox");
            const searchInput = document.getElementById('query');
            let currentEvent = null;

            // Search functionality
            searchInput.addEventListener('input', function() {
                const filter = this.value.toUpperCase();
                const tbody = document.getElementById("myTbody");
                const tr = tbody.getElementsByTagName('tr');

                for (let i = 0; i < tr.length; i++) {
                    const td = tr[i].getElementsByTagName("td")[0];
                    if (td) {
                        const txtValue = td.textContent || td.innerText;
                        tr[i].style.display = txtValue.toUpperCase().indexOf(filter) > -1 ? "" : "none";
                    }
                }
            });

        
            document.addEventListener('click', function(e) {
                if (e.target.closest('.editBtn')) {
                    currentEvent = e.target.closest(".event");
                    editBox.style.display = "block";

                    document.getElementById("eventinput").value = currentEvent.querySelector(".event-name").textContent.trim();
                    document.getElementById("dateInput").value = currentEvent.querySelector(".event-date").textContent.trim();
                    document.getElementById("timeSelect").value = currentEvent.querySelector(".event-time").textContent.trim();
                    document.getElementById("hallSelect").value = currentEvent.querySelector(".event-hall").textContent.trim();
                    document.getElementById("facultySelect").value = currentEvent.querySelector(".event-faculty").textContent.trim();
                    document.getElementById("statusSelect").value = currentEvent.querySelector(".status").textContent.trim();
                }

                if (e.target.closest('.deleteBtn')) {
                    const eventToDelete = e.target.closest(".event");
                    if (confirm("Are you sure you want to delete this event?")) {
                        eventToDelete.remove();
                    }
                }
            });

            document.getElementById("applyBtn").addEventListener("click", () => {
                if (!currentEvent) return;

                const fields = [
                    { selector: ".event-name", value: document.getElementById("eventinput").value },
                    { selector: ".event-date", value: document.getElementById("dateInput").value },
                    { selector: ".event-time", value: document.getElementById("timeSelect").value },
                    { selector: ".event-hall", value: document.getElementById("hallSelect").value },
                    { selector: ".event-faculty", value: document.getElementById("facultySelect").value }
                ];

                fields.forEach(field => {
                    if (field.value) {
                        currentEvent.querySelector(field.selector).textContent = field.value;
                    }
                });

                const statusValue = document.getElementById("statusSelect").value;
                if (statusValue) {
                    const statusElement = currentEvent.querySelector(".status");
                    statusElement.textContent = statusValue;
                  
                    if (statusValue === "Upcoming") statusElement.style.backgroundColor = "aquamarine";
                    else if (statusValue === "Pending") statusElement.style.backgroundColor = "rgb(242, 52, 5)", statusElement.style.color="white";
                    else if (statusValue === "Completed") statusElement.style.backgroundColor = "rgb(162, 182, 175)";
                }

                editBox.style.display = "none";
            });

            document.getElementById("closeBtn").addEventListener("click", () => {
                editBox.style.display = "none";
            });

            
            document.getElementById("deleteBtn").addEventListener("click", () => {
                if (currentEvent && confirm("Are you sure you want to delete this event?")) {
                    currentEvent.remove();
                    editBox.style.display = "none";
                }
            });

          
            document.querySelector('.btn-secondary').addEventListener('click', function(e) {
                e.preventDefault();

                const newRow = document.createElement('tr');
                newRow.className = 'event';
                newRow.innerHTML = `
                    <td class="event-name">New Event</td>
                    <td class="event-date">11/20/2025</td>
                    <td class="event-time">02:00 PM</td>
                    <td class="event-hall">Main Hall</td>
                    <td class="event-faculty">Business Administration</td>
                    <td>0/50</td>
                    <td><span class="status" style="background-color: aquamarine;">Upcoming</span></td>
                    <td>
                        <button class="editBtn"><i class="fa-regular fa-pen-to-square"></i></button>
                        <button class="deleteBtn"><i class="fa-solid fa-trash"></i></button>
                    </td>
                `;

                document.getElementById('myTbody').appendChild(newRow);
            });

            
            window.addEventListener('message', function(event) {
                if (event.data.type === 'NAVIGATE') {
                    window.location.href = event.data.url;
                }
            });


        });

        // Function to load halls from localStorage into the hall select dropdown
function loadHallsIntoSelect() {
    const savedHalls = localStorage.getItem('eventHalls');
    const hallSelect = document.getElementById('hallSelect');
    
    if (savedHalls) {
        const halls = JSON.parse(savedHalls);
        // Clear existing options except the first one
        while (hallSelect.children.length > 1) {
            hallSelect.removeChild(hallSelect.lastChild);
        }
        
        // Add halls from localStorage
        halls.forEach(hall => {
            if (hall.status === 'Available') {
                const option = document.createElement('option');
                option.value = hall.name;
                option.textContent = hall.name;
                hallSelect.appendChild(option);
            }
        });
    }
}



    </script>
</body>
</html>

